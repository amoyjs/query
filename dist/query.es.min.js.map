{"version":3,"file":"query.es.min.js","sources":["../src/globals/extend.ts","../src/core/createQuery.ts","../src/extension/events.ts","../src/core/index.ts"],"sourcesContent":["export function extend(object: any = {}) {\n    Object.assign(this.prototype, object)\n}","export function createQuery(stage: any, query: () => void) {\n    return (selector: any) => {\n        const com = []\n        const type = typeof selector\n\n        switch (type) {\n            case 'string':\n                const parsed = parseStringQuery(selector)\n                parsed.map((item) => {\n                    com.push(...findBy(item.key, item.value, get(stage)))\n                })\n                break\n            case 'object':\n                com.push(...find(selector, get(stage)))\n                break\n            default:\n                break\n        }\n        return Object.assign(com, query.prototype)\n    }\n}\n\nconst REG_PROP = /\\[(.*)\\=(.*)\\]/ // 匹配 `[${key}=${value}]` 形式字符串\n\nfunction parseStringQuery(query: string = '') {\n    const result = []\n    query.split(',').map((query: string) => {\n        query = query.trim()\n        if (query.startsWith('.')) {\n            result.push({\n                key: 'name',\n                value: query.slice(1),\n            })\n        }\n        if (REG_PROP.test(query)) {\n            const [key, value] = parsePropQuery(query)\n            result.push({\n                key,\n                value,\n            })\n        }\n    })\n    return result\n}\n\nfunction parsePropQuery(string: string) {\n    const [_, key, value] = string.match(REG_PROP)\n    return [key, value]\n}\n\nfunction get(object: any) {\n    const result = []\n    const walk = (object: any) => {\n        if (object.children.length > 0) {\n            result.push(...object.children)\n            object.children.map((child: any) => walk(child))\n        }\n    }\n    walk(object)\n    return result\n}\n\nfunction find(item: any, array: any[]) {\n    return array.filter((_item) => _item === item)\n}\n\nfunction findBy(key: string, value: any, array: any[]) {\n    return array.filter((item) => item[key] === value)\n}","export function on(name: string = '', closure: () => void = () => {}) {\n    const events = name.split(' ')\n    for (let i = 0; i < this.length; i++) {\n        for (let j = 0; j < events.length; j++) {\n            this[i].interactive = true\n            this[i].on(events[j], closure)\n        }\n    }\n}\n\nexport function off(name: string = '') {\n    const events = name.split(' ')\n    for (let i = 0; i < this.length; i++) {\n        for (let j = 0; j < events.length; j++) {\n            this[i].off(events[j])\n        }\n    }\n}","import { extend } from '../globals'\nimport { createQuery } from './createQuery'\nimport * as extension from '../extension'\n\n// @ts-ignore\nexport const query = (stage: any) => window.$ = createQuery(stage, query)\n\nquery.extend = extend\n\nquery.extend(extension)\n\n"],"names":["extend","object","Object","assign","prototype","createQuery","stage","query","selector","com","parsed","parseStringQuery","map","item","push","findBy","key","value","get","find","REG_PROP","result","split","trim","startsWith","slice","test","_a","parsePropQuery","string","_","walk","children","length","child","array","filter","_item","on","name","closure","events","i","j","interactive","off","window","$","extension"],"mappings":"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"}